{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport request from \"@/utility/request\";\nexport default {\n  mounted() {\n    let kind = \"all\";\n    request.post(\"http://localhost:8080/product/selectInfoByKind\", kind).then(result => {\n      // result = Result类对象，其data字段为Product类对象列表\n      this.catalogue = result.data;\n    });\n  },\n  beforeDestroy() {},\n  data() {\n    return {\n      // 商品图片源地址\n      baseImageUrl: 'http://localhost:8080/images/download/',\n      // 商品目录\n      catalogue: [],\n      //name: string, price: int\n      //当地时间\n      currentTime: new Date(),\n      productForm: {\n        managerID: 1,\n        kind: '',\n        name: '',\n        price: 0,\n        imageUrl: ''\n      },\n      // 对话框可见标志\n      dialogFormVisible: false,\n      formLabelWidth: '120px'\n    };\n  },\n  computed: {\n    getUserID() {\n      return this.$parent.userID;\n    }\n  },\n  methods: {\n    // 从商品目录删除某个商品\n    deleteGoods(ID, imageUrl) {\n      alert(imageUrl);\n      this.catalogue = this.catalogue.filter(item => item.id !== ID);\n      request.post(\"http://localhost:8080/product/delete\", ID);\n      request.post(\"http://localhost:8080/images/delete\", imageUrl);\n      this.$message.success(\"删除成功\");\n    },\n    // 获取上传的图片文件名 response为Result类对象,并且执行插入商品到数据库操作\n    handleSuccess(response) {\n      this.productForm.imageUrl = response.msg;\n      this.catalogue.push({\n        'managerID': 1,\n        'kind': this.productForm.kind,\n        'name': this.productForm.name,\n        'price': this.productForm.price,\n        \"imageUrl\": this.productForm.imageUrl\n      });\n      request.post(\"http://localhost:8080/product/add\", this.productForm);\n      this.dialogFormVisible = false;\n      this.$message.success(\"添加成功\");\n    },\n    // 处理文件个数超出限制\n    handleExceed() {\n      this.$notify.error(\"最多只能上传一张商品图片\");\n    },\n    // 添加新商品\n    addGoods() {\n      // 触发组件上传文件事件\n      this.$refs.upload.submit();\n    },\n    // 更新单个商品信息\n    updateProduct(project) {\n      request.post(\"http://localhost:8080/product/updateInfo\", project);\n      this.$message.success(\"更新成功\");\n    }\n  }\n};","map":{"version":3,"names":["request","mounted","kind","post","then","result","catalogue","data","beforeDestroy","baseImageUrl","currentTime","Date","productForm","managerID","name","price","imageUrl","dialogFormVisible","formLabelWidth","computed","getUserID","$parent","userID","methods","deleteGoods","ID","alert","filter","item","id","$message","success","handleSuccess","response","msg","push","handleExceed","$notify","error","addGoods","$refs","upload","submit","updateProduct","project"],"sources":["src/views/userSpace/manager/catalogueView.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-table height=\"400\" :data=\"catalogue\" border\r\n              :highlight-current-row=\"true\" :row-style=\"{height:'100px'}\">\r\n      <el-table-column width=\"40px\" type=\"selection\">\r\n      </el-table-column>\r\n      <el-table-column label=\"商品信息\">\r\n        <template slot-scope=\"{row}\">\r\n          <el-image :src=(baseImageUrl+row.imageUrl) alt=\"\" class=\"img_Product\"></el-image>\r\n          <el-input minlength=\"1\" maxlength=\"50\" show-word-limit v-model=\"row.name\"></el-input>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"商品种类\" prop=\"kind\">\r\n        <template slot-scope=\"{row}\">\r\n          <el-select v-model=\"row.kind\" placeholder=\"请选择商品种类\">\r\n            <el-option label=\"笔记本电脑\" value=\"笔记本电脑\"></el-option>\r\n            <el-option label=\"台式电脑\" value=\"台式电脑\"></el-option>\r\n            <el-option label=\"平板电脑\" value=\"平板电脑\"></el-option>\r\n            <el-option label=\"手机通信\" value=\"手机通信\"></el-option>\r\n            <el-option label=\"智能产品\" value=\"智能产品\"></el-option>\r\n            <el-option label=\"配件办公\" value=\"配件办公\"></el-option>\r\n          </el-select>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"单价(￥)\" prop=\"price\">\r\n        <template slot-scope=\"{row}\">\r\n          <el-input-number v-model=\"row.price\"></el-input-number>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" prop=\"id\">\r\n        <template slot-scope=\"{row}\">\r\n          <el-button @click=\"updateProduct(row)\">更新</el-button>\r\n          <el-popconfirm title=\"确定要删除该商品吗？\" @confirm=\"deleteGoods(row.id,row.imageUrl)\">\r\n            <el-button slot=\"reference\">删除</el-button>\r\n          </el-popconfirm>\r\n          <el-button>还原</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-button type=\"text\" @click=\"dialogFormVisible = true\">添加新商品</el-button>\r\n    <el-dialog title=\"新商品信息\" :visible.sync=\"dialogFormVisible\">\r\n      <el-form :model=\"productForm\">\r\n        <el-form-item label=\"商家ID\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"productForm.managerID\" disabled></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"商品种类\" :label-width=\"formLabelWidth\">\r\n          <el-select v-model=\"productForm.kind\" placeholder=\"请选择合适种类\">\r\n            <el-option label=\"笔记本电脑\" value=\"笔记本电脑\"></el-option>\r\n            <el-option label=\"台式电脑\" value=\"台式电脑\"></el-option>\r\n            <el-option label=\"平板电脑\" value=\"平板电脑\"></el-option>\r\n            <el-option label=\"手机通信\" value=\"手机通信\"></el-option>\r\n            <el-option label=\"智能产品\" value=\"智能产品\"></el-option>\r\n            <el-option label=\"配件办公\" value=\"配件办公\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"商品名称\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"productForm.name\" minlength=\"1\" maxlength=\"50\" show-word-limit></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"单价(￥)\" :label-width=\"formLabelWidth\">\r\n          <el-input-number v-model=\"productForm.price\"></el-input-number>\r\n        </el-form-item>\r\n        <el-form-item label=\"商品图片\" :label-width=\"formLabelWidth\">\r\n          <el-upload\r\n              class=\"upload-demo\"\r\n              drag\r\n              ref=\"upload\"\r\n              action=\"http://localhost:8080/images/upload\"\r\n              :limit=\"1\"\r\n              :auto-upload=\"false\"\r\n              :on-success=\"handleSuccess\"\r\n              :on-exceed=\"handleExceed\">\r\n            <i class=\"el-icon-upload\"></i>\r\n            <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n          </el-upload>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"addGoods()\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\n\r\nimport request from \"@/utility/request\";\r\n\r\nexport default {\r\n  mounted() {\r\n    let kind = \"all\"\r\n    request.post(\"http://localhost:8080/product/selectInfoByKind\", kind)\r\n        .then(result => {\r\n          // result = Result类对象，其data字段为Product类对象列表\r\n          this.catalogue = result.data\r\n        })\r\n  },\r\n  beforeDestroy() {\r\n\r\n  },\r\n  data() {\r\n    return {\r\n      // 商品图片源地址\r\n      baseImageUrl: 'http://localhost:8080/images/download/',\r\n      // 商品目录\r\n      catalogue: [], //name: string, price: int\r\n      //当地时间\r\n      currentTime: new Date(),\r\n      productForm: {\r\n        managerID: 1,\r\n        kind: '',\r\n        name: '',\r\n        price: 0,\r\n        imageUrl: ''\r\n      },\r\n      // 对话框可见标志\r\n      dialogFormVisible: false,\r\n      formLabelWidth: '120px'\r\n    };\r\n  },\r\n  computed: {\r\n    getUserID() {\r\n      return this.$parent.userID\r\n    }\r\n  },\r\n  methods: {\r\n    // 从商品目录删除某个商品\r\n    deleteGoods(ID,imageUrl) {\r\n      alert(imageUrl)\r\n      this.catalogue = this.catalogue.filter(item => item.id !== ID);\r\n      request.post(\"http://localhost:8080/product/delete\", ID);\r\n      request.post(\"http://localhost:8080/images/delete\", imageUrl)\r\n      this.$message.success(\"删除成功\")\r\n    },\r\n    // 获取上传的图片文件名 response为Result类对象,并且执行插入商品到数据库操作\r\n    handleSuccess(response) {\r\n      this.productForm.imageUrl = response.msg\r\n      this.catalogue.push({\r\n        'managerID': 1,\r\n        'kind': this.productForm.kind,\r\n        'name': this.productForm.name,\r\n        'price': this.productForm.price,\r\n        \"imageUrl\": this.productForm.imageUrl\r\n      });\r\n      request.post(\"http://localhost:8080/product/add\", this.productForm);\r\n      this.dialogFormVisible = false\r\n      this.$message.success(\"添加成功\")\r\n    },\r\n    // 处理文件个数超出限制\r\n    handleExceed(){\r\n      this.$notify.error(\"最多只能上传一张商品图片\")\r\n    },\r\n    // 添加新商品\r\n    addGoods() {\r\n      // 触发组件上传文件事件\r\n      this.$refs.upload.submit();\r\n    },\r\n    // 更新单个商品信息\r\n    updateProduct(project) {\r\n      request.post(\"http://localhost:8080/product/updateInfo\", project);\r\n      this.$message.success(\"更新成功\")\r\n    },\r\n  }\r\n}\r\n;\r\n</script>\r\n<style scoped>\r\n\r\n\r\ndiv {\r\n  box-sizing: content-box;\r\n}\r\n\r\n.img_Product {\r\n  width: 160px;\r\n  height: 160px;\r\n  display: block;\r\n  text-align: center;\r\n  cursor: pointer;\r\n  overflow: hidden;\r\n  padding-bottom: 10px;\r\n  position: relative;\r\n}\r\n\r\nel-table-column {\r\n  text-align: center;\r\n}\r\n\r\n</style>"],"mappings":";AAqFA,OAAAA,OAAA;AAEA;EACAC,QAAA;IACA,IAAAC,IAAA;IACAF,OAAA,CAAAG,IAAA,mDAAAD,IAAA,EACAE,IAAA,CAAAC,MAAA;MACA;MACA,KAAAC,SAAA,GAAAD,MAAA,CAAAE,IAAA;IACA;EACA;EACAC,cAAA,GAEA;EACAD,KAAA;IACA;MACA;MACAE,YAAA;MACA;MACAH,SAAA;MAAA;MACA;MACAI,WAAA,MAAAC,IAAA;MACAC,WAAA;QACAC,SAAA;QACAX,IAAA;QACAY,IAAA;QACAC,KAAA;QACAC,QAAA;MACA;MACA;MACAC,iBAAA;MACAC,cAAA;IACA;EACA;EACAC,QAAA;IACAC,UAAA;MACA,YAAAC,OAAA,CAAAC,MAAA;IACA;EACA;EACAC,OAAA;IACA;IACAC,YAAAC,EAAA,EAAAT,QAAA;MACAU,KAAA,CAAAV,QAAA;MACA,KAAAV,SAAA,QAAAA,SAAA,CAAAqB,MAAA,CAAAC,IAAA,IAAAA,IAAA,CAAAC,EAAA,KAAAJ,EAAA;MACAzB,OAAA,CAAAG,IAAA,yCAAAsB,EAAA;MACAzB,OAAA,CAAAG,IAAA,wCAAAa,QAAA;MACA,KAAAc,QAAA,CAAAC,OAAA;IACA;IACA;IACAC,cAAAC,QAAA;MACA,KAAArB,WAAA,CAAAI,QAAA,GAAAiB,QAAA,CAAAC,GAAA;MACA,KAAA5B,SAAA,CAAA6B,IAAA;QACA;QACA,aAAAvB,WAAA,CAAAV,IAAA;QACA,aAAAU,WAAA,CAAAE,IAAA;QACA,cAAAF,WAAA,CAAAG,KAAA;QACA,iBAAAH,WAAA,CAAAI;MACA;MACAhB,OAAA,CAAAG,IAAA,2CAAAS,WAAA;MACA,KAAAK,iBAAA;MACA,KAAAa,QAAA,CAAAC,OAAA;IACA;IACA;IACAK,aAAA;MACA,KAAAC,OAAA,CAAAC,KAAA;IACA;IACA;IACAC,SAAA;MACA;MACA,KAAAC,KAAA,CAAAC,MAAA,CAAAC,MAAA;IACA;IACA;IACAC,cAAAC,OAAA;MACA5C,OAAA,CAAAG,IAAA,6CAAAyC,OAAA;MACA,KAAAd,QAAA,CAAAC,OAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}